openapi: 3.0.0

info:
  description: >
    Land Cover Classification System Web Service. You can find out more about LCCS-WS at [https://github.com/brazil-data-cube/lccs-ws](https://github.com/brazil-data-cube/lccs-ws)

  version: '0.2.0'

  title: Land Cover Classification System Web Service

  contact:
    name: Fabiana Zioti
    email: fabi.zioti@gmail.com

  license:
    name: MIT
    url: 'https://opensource.org/licenses/MIT'

servers:
  - url: 'https://localhost/lccs-ws'
    description: Production server


paths:

  '/classification_systems':
    get:
      tags:
        - Classification Systems
      summary: List Classification System.
      description: Retrieve list of available classification systems.
      operationId: getClassificationSystems
      responses:
        '200':
          $ref: '#/components/responses/ClassificationSystems'
        '500':
          $ref: '#/components/responses/ServerError'

  '/classification_systems/{systemId}':
    parameters:
       - $ref: '#/components/parameters/systemId'
    get:
      tags:
        - Classification Systems
      summary: >
        Describe the classification system with id `systemId`
      description: Returns information of classification system by Id.
      operationId: describeClassificationSystem
      responses:
        '200':
          $ref: '#/components/responses/ClassificationSystem'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'

  '/classification_systems/{systemId}/classes':
    get:
      tags:
        - Classes
      summary: fetch classes
      description: >
        Fetch classes of the classification with id `systemId`.
      operationId: getClasses
      parameters:
        - $ref: '#/components/parameters/systemId'
      responses:
        '400':
          $ref: '#/components/responses/InvalidParameter'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
        '200':
          $ref: '#/components/responses/Classes'

  '/classification_systems/{systemId}/classes/{classeId}':
    get:
      tags:
        - Classes
      summary: fetch a single classe
      description: >
          Fetch the classe with id `classeId` in the classification system
          with id `systemId`.
      operationId: getClasse
      parameters:
          - $ref: '#/components/parameters/systemId'
          - $ref: '#/components/parameters/classeId'
      responses:
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
        '200':
          $ref: '#/components/responses/Classe'

  '/mappings/{systemIdSource}/{systemIdTarget}':
    get:
      tags:
        - Classification Systems
      summary: Retrives classification systems mappings
      description: Mapping of classification systems.
      operationId: getMapping
      parameters:
        - $ref: '#/components/parameters/systemIdSource'
        - $ref: '#/components/parameters/systemIdTarget'
      responses:
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
        '200':
          $ref: '#/components/responses/Mappings'

components:

  #-------------------------------
  # Reusable operation parameters
  #-------------------------------

  parameters:

    systemId:
      name: systemId
      in: path
      description: Identifier (name) of a classification system
      required: true
      schema:
        type: string

    classeId:
      name: classeId
      in: path
      description: Identifier (name) of a class
      required: true
      schema:
        type: string

    systemIdSource:
      name: systemIdSource
      in: path
      description: Identifier (name) of a source classification system
      required: true
      schema:
        type: string

    systemIdTarget:
      name: systemIdTarget
      in: path
      description: Identifier (name) of a target classification system
      required: true
      schema:
        type: string


  #-------------------------------
  # Reusable schemas (data models)
  #-------------------------------

  schemas:

    classification_system:
      type: object
      required:
        - id
        - name
        - links
      properties:
        id:
          type: number
        name:
          type: string
        authority_name:
          type: string
        description:
          type: string
        version:
          type: string
        links:
          type: array
          items:
            $ref: "#/components/schemas/link"
          example:
            - href: http://data.example.com/buildings
              rel: item


    classification_systems:
      type: object
      required:
        - links
        - classification_system
      properties:
        links:
          type: array
          items:
            $ref: "#/components/schemas/link"
        collections:
          type: array
          items:
            $ref: "#/components/schemas/classification_system"


    classes:
      type: object
      required:
        - classes
      properties:
        classe:
          type: array
          items:
            $ref: "#/components/schemas/classe"
        links:
          type: array
          items:
            $ref: "#/components/schemas/link"

    classe:
      type: object
      required:
        - name
        - id
      properties:
        id:
          type: number
        name:
          type: string
        code:
          type: string
        description:
          type: string
        style:
          type: string
        parent:
          type: object
          items:
            $ref: "#/components/schemas/classe"
        links:
          type: array
          items:
            $ref: "#/components/schemas/link"

    mapping:
      type: object
      properties:
        links:
          type: array
          items:
            $ref: "#/components/schemas/link"
        classe_source:
          type: object
          items:
            $ref: "#/components/schemas/classe"
        classe_target:
          type: object
          items:
            $ref: "#/components/schemas/classe"
        description:
          type: string
        degree_of_similarity:
          type: number

    mappings:
      type: array
      items:
        $ref: "#/components/schemas/mapping"

    link:
      title: Link
      description: A generic link.
      type: object
      required:
        - href
        - rel
      properties:
        href:
          type: string
          format: url
          example: 'http://www.geoserver.example/stac/naip/child/catalog.json'
        rel:
          type: string
          example: child
        type:
          type: string
          example: application/json
        title:
          type: string
          example: Child

    exception:
      type: object
      description: >
        Information about the exception: an error code plus an optional description.
      required:
        - code
      properties:
        code:
          type: string
        description:
          type: string

  responses:


    ClassificationSystems:
      description: >
        The classsification systems shared by this API.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/classification_systems'

    ClassificationSystem:
      description: >
        Information about classification system id `systemId`.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/classification_system'

    Classes:
      description: >
        The response is a document consisting of classes in the classification system.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/classes'

    Classe:
      description: >
        fetch the classe with id `classeId` in the classification system
        with id `systemId`
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/classe'


    Mappings:
      description: >
        fetch the mapping with `systemIdSource` and `systemIdTarget`.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/mappings'

    ServerError:
      description: >
        A server error occurred.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/exception'
        text/html:
          schema:
            type: string

    NotFound:
      description: >
        The requested URI was not found.

    InvalidParameter:
      description: >
        A query parameter has an invalid value.